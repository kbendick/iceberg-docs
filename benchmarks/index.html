<!doctype html><html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=author content>
<base href=https://iceberg.apache.org/>
<title>Benchmarks</title>
<link href=https://iceberg.apache.org//css/bootstrap.css rel=stylesheet>
<link href=https://iceberg.apache.org//css/landing-page.css rel=stylesheet>
<link href=https://iceberg.apache.org//css/markdown.css rel=stylesheet>
<link href=https://iceberg.apache.org//css/katex.min.css rel=stylesheet>
<link rel=stylesheet href=https://iceberg.apache.org//css/pricing.css>
<link href=https://iceberg.apache.org//font-awesome-4.7.0/css/font-awesome.min.css rel=stylesheet type=text/css>
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel=stylesheet type=text/css>
<link href=https://iceberg.apache.org//css/termynal.css rel=stylesheet>
</head>
<body>
<head>
<link href=https://iceberg.apache.org//css/markdown.css rel=stylesheet>
<link href=https://iceberg.apache.org//css/katex.min.css rel=stylesheet>
</head>
<nav class="navbar navbar-default navbar-fixed-top" role=navigation>
<div class=container>
<div class="navbar-header page-scroll">
<button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class="page-scroll navbar-brand" href=#intro><img class=top-navbar-logo src=https://iceberg.apache.org//img/iceberg-logo-icon.png> Apache Iceberg</a>
</div>
<div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1>
<ul class="nav navbar-nav navbar-right">
<li>
<a class=page-scroll href=https://iceberg.apache.org/docs/latest>Docs</a>
</li>
<li>
<a class=page-scroll href=https://iceberg.apache.org/docs/latest/getting-started/>Spark</a>
</li>
<li>
<a class=page-scroll href=https://iceberg.apache.org/docs/latest/flink/>Flink</a>
</li>
<li>
<a class=page-scroll href=https://trino.io/docs/current/connector/iceberg.html target=_blank>Trino</a>
</li>
<li>
<a class=page-scroll href=https://prestodb.io/docs/current/connector/iceberg.html target=_blank>Presto</a>
</li>
<li>
<a class=page-scroll href=https://iceberg.apache.org/releases>Releases</a>
</li>
<li>
<a class=page-scroll href=https://iceberg.apache.org/roadmap>Roadmap</a>
</li>
<li>
<a class=page-scroll href=https://iceberg.apache.org/community>Community</a>
</li>
<li>
<a class=page-scroll href=https://iceberg.apache.org/blogs>Blogs</a>
</li>
<li>
<a class=page-scroll href=https://iceberg.apache.org/talks>Talks</a>
</li>
</ul>
</div>
</div>
</nav>
<div class=pad-for-navbar></div>
<body dir=" ltr">
<div class=markdown-body>
<h2 id=available-benchmarks-and-how-to-run-them>Available Benchmarks and how to run them</h2>
<p>Benchmarks are located under <code>&lt;project-name>/jmh</code>. It is generally favorable to only run the tests of interest rather than running all available benchmarks.
Also note that JMH benchmarks run within the same JVM as the system-under-test, so results might vary between runs.</p>
<h2 id=running-benchmarks-on-github>Running Benchmarks on GitHub</h2>
<p>It is possible to run one or more Benchmarks via the <strong>JMH Benchmarks</strong> GH action on your own fork of the Iceberg repo. This GH action takes the following inputs:</p>
<ul>
<li>The repository name where those benchmarks should be run against, such as <code>apache/iceberg</code> or <code>&lt;user>/iceberg</code></li>
<li>The branch name to run benchmarks against, such as <code>master</code> or <code>my-cool-feature-branch</code></li>
<li>A list of comma-separated double-quoted Benchmark names, such as <code>"IcebergSourceFlatParquetDataReadBenchmark", "IcebergSourceFlatParquetDataFilterBenchmark", "IcebergSourceNestedListParquetDataWriteBenchmark"</code></li>
</ul>
<p>Benchmark results will be uploaded once <strong>all</strong> benchmarks are done.</p>
<p>It is worth noting that the GH runners have limited resources so the benchmark results should rather be seen as an indicator to guide developers in understanding code changes.
It is likely that there is variability in results across different runs, therefore the benchmark results shouldn&rsquo;t be used to form assumptions around production choices.</p>
<h2 id=running-benchmarks-locally>Running Benchmarks locally</h2>
<p>Below are the existing benchmarks shown with the actual commands on how to run them locally.</p>
<h3 id=icebergsourcenestedlistparquetdatawritebenchmark>IcebergSourceNestedListParquetDataWriteBenchmark</h3>
<p>A benchmark that evaluates the performance of writing nested Parquet data using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceNestedListParquetDataWriteBenchmark -PjmhOutputPath=benchmark/iceberg-source-nested-list-parquet-data-write-benchmark-result.txt</code></p>
<h3 id=sparkparquetreadersnesteddatabenchmark>SparkParquetReadersNestedDataBenchmark</h3>
<p>A benchmark that evaluates the performance of reading nested Parquet data using Iceberg and Spark Parquet readers. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=SparkParquetReadersNestedDataBenchmark -PjmhOutputPath=benchmark/spark-parquet-readers-nested-data-benchmark-result.txt</code></p>
<h3 id=sparkparquetwritersflatdatabenchmark>SparkParquetWritersFlatDataBenchmark</h3>
<p>A benchmark that evaluates the performance of writing Parquet data with a flat schema using Iceberg and Spark Parquet writers. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=SparkParquetWritersFlatDataBenchmark -PjmhOutputPath=benchmark/spark-parquet-writers-flat-data-benchmark-result.txt</code></p>
<h3 id=icebergsourceflatorcdatareadbenchmark>IcebergSourceFlatORCDataReadBenchmark</h3>
<p>A benchmark that evaluates the performance of reading ORC data with a flat schema using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceFlatORCDataReadBenchmark -PjmhOutputPath=benchmark/iceberg-source-flat-orc-data-read-benchmark-result.txt</code></p>
<h3 id=sparkparquetreadersflatdatabenchmark>SparkParquetReadersFlatDataBenchmark</h3>
<p>A benchmark that evaluates the performance of reading Parquet data with a flat schema using Iceberg and Spark Parquet readers. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=SparkParquetReadersFlatDataBenchmark -PjmhOutputPath=benchmark/spark-parquet-readers-flat-data-benchmark-result.txt</code></p>
<h3 id=vectorizedreaddictionaryencodedflatparquetdatabenchmark>VectorizedReadDictionaryEncodedFlatParquetDataBenchmark</h3>
<p>A benchmark to compare performance of reading Parquet dictionary encoded data with a flat schema using vectorized Iceberg read path and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=VectorizedReadDictionaryEncodedFlatParquetDataBenchmark -PjmhOutputPath=benchmark/vectorized-read-dict-encoded-flat-parquet-data-result.txt</code></p>
<h3 id=icebergsourcenestedlistorcdatawritebenchmark>IcebergSourceNestedListORCDataWriteBenchmark</h3>
<p>A benchmark that evaluates the performance of writing nested Parquet data using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceNestedListORCDataWriteBenchmark -PjmhOutputPath=benchmark/iceberg-source-nested-list-orc-data-write-benchmark-result.txt</code></p>
<h3 id=vectorizedreadflatparquetdatabenchmark>VectorizedReadFlatParquetDataBenchmark</h3>
<p>A benchmark to compare performance of reading Parquet data with a flat schema using vectorized Iceberg read path and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=VectorizedReadFlatParquetDataBenchmark -PjmhOutputPath=benchmark/vectorized-read-flat-parquet-data-result.txt</code></p>
<h3 id=icebergsourceflatparquetdatawritebenchmark>IcebergSourceFlatParquetDataWriteBenchmark</h3>
<p>A benchmark that evaluates the performance of writing Parquet data with a flat schema using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceFlatParquetDataWriteBenchmark -PjmhOutputPath=benchmark/iceberg-source-flat-parquet-data-write-benchmark-result.txt</code></p>
<h3 id=icebergsourcenestedavrodatareadbenchmark>IcebergSourceNestedAvroDataReadBenchmark</h3>
<p>A benchmark that evaluates the performance of reading Avro data with a flat schema using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceNestedAvroDataReadBenchmark -PjmhOutputPath=benchmark/iceberg-source-nested-avro-data-read-benchmark-result.txt</code></p>
<h3 id=icebergsourceflatavrodatareadbenchmark>IcebergSourceFlatAvroDataReadBenchmark</h3>
<p>A benchmark that evaluates the performance of reading Avro data with a flat schema using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceFlatAvroDataReadBenchmark -PjmhOutputPath=benchmark/iceberg-source-flat-avro-data-read-benchmark-result.txt</code></p>
<h3 id=icebergsourcenestedparquetdatawritebenchmark>IcebergSourceNestedParquetDataWriteBenchmark</h3>
<p>A benchmark that evaluates the performance of writing nested Parquet data using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceNestedParquetDataWriteBenchmark -PjmhOutputPath=benchmark/iceberg-source-nested-parquet-data-write-benchmark-result.txt</code></p>
<h3 id=icebergsourcenestedparquetdatareadbenchmark>IcebergSourceNestedParquetDataReadBenchmark</h3>
<ul>
<li>A benchmark that evaluates the performance of reading nested Parquet data using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</li>
</ul>
<p><code> ./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceNestedParquetDataReadBenchmark -PjmhOutputPath=benchmark/iceberg-source-nested-parquet-data-read-benchmark-result.txt</code></p>
<h3 id=icebergsourcenestedorcdatareadbenchmark>IcebergSourceNestedORCDataReadBenchmark</h3>
<p>A benchmark that evaluates the performance of reading ORC data with a flat schema using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceNestedORCDataReadBenchmark -PjmhOutputPath=benchmark/iceberg-source-nested-orc-data-read-benchmark-result.txt</code></p>
<h3 id=icebergsourceflatparquetdatareadbenchmark>IcebergSourceFlatParquetDataReadBenchmark</h3>
<p>A benchmark that evaluates the performance of reading Parquet data with a flat schema using Iceberg and the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceFlatParquetDataReadBenchmark -PjmhOutputPath=benchmark/iceberg-source-flat-parquet-data-read-benchmark-result.txt</code></p>
<h3 id=icebergsourceflatparquetdatafilterbenchmark>IcebergSourceFlatParquetDataFilterBenchmark</h3>
<p>A benchmark that evaluates the file skipping capabilities in the Spark data source for Iceberg. This class uses a dataset with a flat schema, where the records are clustered according to the
column used in the filter predicate. The performance is compared to the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:</p>
<p><code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceFlatParquetDataFilterBenchmark -PjmhOutputPath=benchmark/iceberg-source-flat-parquet-data-filter-benchmark-result.txt</code></p>
<h3 id=icebergsourcenestedparquetdatafilterbenchmark>IcebergSourceNestedParquetDataFilterBenchmark</h3>
<p>A benchmark that evaluates the file skipping capabilities in the Spark data source for Iceberg. This class uses a dataset with nested data, where the records are clustered according to the
column used in the filter predicate. The performance is compared to the built-in file source in Spark. To run this benchmark for either spark-2 or spark-3:
<code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=IcebergSourceNestedParquetDataFilterBenchmark -PjmhOutputPath=benchmark/iceberg-source-nested-parquet-data-filter-benchmark-result.txt</code></p>
<h3 id=sparkparquetwritersnesteddatabenchmark>SparkParquetWritersNestedDataBenchmark</h3>
<ul>
<li>A benchmark that evaluates the performance of writing nested Parquet data using Iceberg and Spark Parquet writers. To run this benchmark for either spark-2 or spark-3:
<code>./gradlew :iceberg-spark:iceberg-spark[2|3]:jmh -PjmhIncludeRegex=SparkParquetWritersNestedDataBenchmark -PjmhOutputPath=benchmark/spark-parquet-writers-nested-data-benchmark-result.txt</code></li>
</ul>
</div>
</body>
</html>