<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=author content><title>Time Travel and Rollback</title><link href=https://iceberg.apache.org//css/bootstrap.css rel=stylesheet><link href=https://iceberg.apache.org//css/landing-page.css rel=stylesheet><link href=https://iceberg.apache.org//css/markdown.css rel=stylesheet><link href=https://iceberg.apache.org//css/katex.min.css rel=stylesheet><link rel=stylesheet href=https://iceberg.apache.org//css/pricing.css><link href=https://iceberg.apache.org//font-awesome-4.7.0/css/font-awesome.min.css rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel=stylesheet type=text/css><link href=https://iceberg.apache.org//css/termynal.css rel=stylesheet></head><body><head><link href=https://iceberg.apache.org//css/markdown.css rel=stylesheet><link href=https://iceberg.apache.org//css/katex.min.css rel=stylesheet><script>function addAnchor(e){e.insertAdjacentHTML("beforeend",`<a href="#${e.id}" class="anchortag" ariaLabel="Anchor"> ðŸ”— </a>`)}document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll("h1[id], h2[id], h3[id], h4[id]");e&&e.forEach(addAnchor)})</script></head><nav class="navbar navbar-default navbar-fixed-top" role=navigation><div class=container><div class="navbar-header page-scroll"><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class="page-scroll navbar-brand" href=https://iceberg.apache.org/><img class=top-navbar-logo src=https://iceberg.apache.org//img/iceberg-logo-icon.png> Apache Iceberg</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav navbar-right"><li><a class=page-scroll href=https://iceberg.apache.org/docs/latest>Docs</a></li><li><a class=page-scroll href=https://iceberg.apache.org/docs/latest/getting-started/>Spark</a></li><li><a class=page-scroll href=https://iceberg.apache.org/docs/latest/flink/>Flink</a></li><li><a class=page-scroll href=https://trino.io/docs/current/connector/iceberg.html target=_blank>Trino</a></li><li><a class=page-scroll href=https://prestodb.io/docs/current/connector/iceberg.html target=_blank>Presto</a></li><li><a class=page-scroll href=https://iceberg.apache.org/releases>Releases</a></li><li><a class=page-scroll href=https://iceberg.apache.org/roadmap>Roadmap</a></li><li><a class=page-scroll href=https://iceberg.apache.org/community>Community</a></li><li><a class=page-scroll href=https://iceberg.apache.org/blogs>Blogs</a></li><li><a class=page-scroll href=https://iceberg.apache.org/talks>Talks</a></li></ul></div></div></nav><div class=pad-for-navbar></div><body dir=" ltr"><div class=grid-container><div class=markdown-body><div class=termynal-container><div id=termynal-time-travel data-termynal data-ty-startdelay=6000 data-ty-typedelay=20 data-ty-linedelay=500><span data-ty=input data-ty-cursor=â–‹ data-ty-prompt="scala>">spark.read.table("taxis").count()</span>
<span data-ty>2,853,020</span>
<span data-ty=input data-ty-cursor=â–‹ data-ty-prompt="scala>">val ONE_DAY_MS=86400000</span>
<span data-ty=input data-ty-cursor=â–‹ data-ty-prompt="scala>">val NOW=System.currentTimeMillis()</span>
<span data-ty=input data-ty-cursor=â–‹ data-ty-prompt="scala>">val YESTERDAY=NOW - ONE_DAY_MS</span>
<span data-ty=input data-ty-cursor=â–‹ data-ty-prompt="scala>">(spark</span>
<span data-ty=input data-ty-cursor=â–‹ data-ty-prompt>.read</span>
<span data-ty=input data-ty-cursor=â–‹ data-ty-prompt>.option("as-of-timestamp", YESTERDAY)</span>
<span data-ty=input data-ty-cursor=â–‹ data-ty-prompt>.table("taxis")</span>
<span data-ty=input data-ty-cursor=â–‹ data-ty-prompt>.count())</span>
<span data-ty>2,798,371</span></div></div></div></div></body></html>